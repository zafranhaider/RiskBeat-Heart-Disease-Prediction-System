<div id="emailPopup" class="popup">
    <div class="popup-content">
        <span class="close-btn" onclick="closePopup()">&times;</span>
        <h2>Subscribe for Notifications</h2>
        <input type="email" id="subscriberEmail" placeholder="Enter your email" required>
        <button onclick="subscribe()">Subscribe</button>
        <p id="responseMessage"></p>
    </div>
</div>

<style>
.popup {
    display: none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 20px;
    box-shadow: 0px 0px 10px gray;
}
.popup-content {
    text-align: center;
}
.close-btn {
    float: right;
    cursor: pointer;
}
</style>

<script>
function openPopup() {
    document.getElementById('emailPopup').style.display = 'block';
}

function closePopup() {
    document.getElementById('emailPopup').style.display = 'none';
}

function subscribe() {
    var email = document.getElementById("subscriberEmail").value;
    
    fetch("{% url 'subscribe_email' %}", {
        method: "POST",
        headers: {
            "Content-Type": "application/x-www-form-urlencoded",
            "X-CSRFToken": "{{ csrf_token }}"
        },
        body: "email=" + encodeURIComponent(email)
    })
    .then(response => response.json())
    .then(data => {
        document.getElementById("responseMessage").innerText = data.message;
    })
    .catch(error => console.error("Error:", error));
}
</script>
